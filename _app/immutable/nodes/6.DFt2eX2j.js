import"../chunks/CWj6FrbW.js";import{p as S,o as y,a as C,g as o,b as i,c as F,s as H,u as P,d as l,r as x}from"../chunks/B-fbdRLl.js";import{f as z,a as A}from"../chunks/CJ4bccHK.js";import{b as E}from"../chunks/Dw9IwxVR.js";import{i as R,g as U}from"../chunks/Cw4XXSY5.js";import{M as O}from"../chunks/k4haT3Ck.js";import{T as V}from"../chunks/Bbh-480P.js";var X=z('<div class="relative w-screen h-screen overflow-hidden"><!> <!></div>');function Q(w,v){S(v,!0);let c=i(!1),a=i(void 0),d=i(""),m=i(!0);const h={setData(e){l(d,e,!0)},setCursor(e){o(a).setCursor(e)},setFit(e){l(m,e,!0)},downloadSvg(){var r,n;const e=(n=(r=o(a))==null?void 0:r.getMarkmap())==null?void 0:n.svg.node();if(!e)return;const t=new XMLSerializer().serializeToString(e);s("downloadSvg",t)},downloadHtml(){const e=U();if(!e)return;const t=e.transform(o(d));s("downloadHtml",{result:t})},updateTheme(e){R.set(e)}};function f(e){const{type:t,data:r}=e.data,n=h[t];n==null||n(r)}function s(e,t){parent.postMessage({type:e,data:t},window.location.origin)}function b(){s("getData")}function M(){l(c,!0)}function k(){o(a).getMarkmap().g.selectAll(function(){return Array.from(this.childNodes).filter(t=>t.tagName==="g")}).on("dblclick.focus",(e,t)=>{var p;const r=(p=t.payload)==null?void 0:p.lines,n=+(r==null?void 0:r.split(",")[0]);isNaN(n)||s("setCursor",n)},!0)}function _(){s("goToFullPage")}function L(){window.location.reload()}function T(e){const t=new URL(e,window.top.location.href);return t.origin===window.location.origin?s("navigate",e):window.open(t,"_blank"),!1}y(()=>(window.addEventListener("message",f),b(),()=>{window.removeEventListener("message",f)}));var u=X(),g=F(u);E(O(g,{class:"w-full h-full",get fit(){return o(m)},get content(){return o(d)},onLoad:M,onUpdate:k,onReload:L,onOpenLink:T}),e=>l(a,e,!0),()=>o(a));var D=H(g,2);const N=P(()=>{var e;return o(c)?(e=o(a))==null?void 0:e.getMarkmap():void 0});V(D,{class:"absolute right-0 bottom-0 mr-2 mb-2",get markmap(){return o(N)},onFullPageView:_}),x(u),A(w,u),C()}export{Q as component};
